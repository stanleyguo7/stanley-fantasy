from pathlib import Path

worldviews = {
    "01-contemporary-china-2020s": {
        "title": "当代中国（2020s）",
        "phases": [
            "移动互联网深度化期", "平台治理与行业重构期", "家庭与社区再平衡期", "AI进入日常协作期", "个人长期主义重建期"
        ],
        "roles": ["社区工作者", "互联网产品经理", "短视频创作者", "基层医生", "中学教师", "外卖站点调度", "公益志愿者", "创业者"],
        "conflicts": ["效率与公平", "职业发展与家庭照护", "流量与真实", "个人选择与社会期待", "技术便利与隐私边界"],
    },
    "02-china-1980s": {
        "title": "中国80年代",
        "phases": ["观念松动期", "单位与市场并行期", "个体经济萌芽期", "城乡机会分化期", "价值再选择期"],
        "roles": ["国营厂技术员", "供销社职员", "个体摊主", "乡镇干部", "青年教师", "文艺青年", "返乡知青", "厂医"],
        "conflicts": ["稳定与冒险", "集体秩序与个人理想", "城乡身份差异", "资源稀缺下的道德选择", "代际沟通"],
    },
    "03-china-1990s": {
        "title": "中国90年代",
        "phases": ["市场化提速期", "国企转轨期", "南下流动期", "民营扩张期", "世纪交替预热期"],
        "roles": ["国企转岗职工", "外贸业务员", "个体老板", "货运司机", "县城记者", "职业学校教师", "沿海工厂班组长", "家电销售员"],
        "conflicts": ["身份重塑", "机会与风险", "家庭分离与团聚", "诚信与效率", "资本与劳动"],
    },
    "04-three-kingdoms": {
        "title": "三国时期",
        "phases": ["群雄并起", "联盟与背盟", "战略相持", "南北消长", "统一前夜"],
        "roles": ["郡县小吏", "军中司马", "斥候", "医官", "粮道护卫", "游侠", "谋士门客", "工匠"],
        "conflicts": ["忠义与生存", "军功与民生", "盟约与背叛", "家族与国家", "名望与现实"],
    },
    "05-five-dynasties-ten-kingdoms": {
        "title": "五代十国",
        "phases": ["政权频替初期", "地方割据深化", "贸易与战事并行", "区域整合试探", "统一前震荡"],
        "roles": ["节度使幕僚", "商队领队", "城防将校", "流亡文士", "地方医者", "寺院执事", "情报中人", "漕运书记"],
        "conflicts": ["忠诚转移", "秩序重建", "地方利益与中央号令", "生存伦理", "乱世信誉"],
    },
    "06-legend-of-condor-heroes": {
        "title": "射雕英雄传范式",
        "phases": ["江湖入门期", "门派与家国纠葛期", "高手博弈期", "边地危机期", "传承定型期"],
        "roles": ["门派新弟子", "镖局趟子手", "边地义士", "江湖郎中", "散修游侠", "门派执事", "情报探子", "客栈掌柜"],
        "conflicts": ["师门戒律与侠义", "名声与真相", "家国责任", "传承与机缘", "恩怨循环"],
    },
    "07-smiling-proud-wanderer": {
        "title": "笑傲江湖范式",
        "phases": ["门派秩序稳定表象期", "内部权斗升温期", "联盟重组期", "江湖失序期", "新秩序试建期"],
        "roles": ["门派弟子", "长老亲传", "散人剑客", "情报客", "叛门者", "中立调停人", "镖局管事", "医者"],
        "conflicts": ["组织忠诚与个人自由", "名门形象与现实手段", "师徒伦理", "秘籍争夺", "江湖舆论"],
    },
    "08-harry-potter": {
        "title": "哈利波特范式",
        "phases": ["学年开端期", "校园异常期", "校外社会牵动期", "高风险对抗期", "秩序修复期"],
        "roles": ["新生巫师", "级长", "魔药俱乐部成员", "神奇生物志愿者", "图书馆助理", "记者型学生", "魔法部实习生", "治疗师学徒"],
        "conflicts": ["规则与道德", "学院竞争与友谊", "血统偏见与能力成长", "隐瞒与公开", "个人选择与集体安全"],
    },
}

def mk_event(i, phase, roles, conflicts, title):
    era = f"阶段{(i-1)//10 + 1}"
    r1, r2 = roles[(i*2) % len(roles)], roles[(i*2+3) % len(roles)]
    cf = conflicts[i % len(conflicts)]
    seed = [
        "物资调度异常", "一封匿名线索", "一次公开选拔", "旧案重启", "边缘群体求助",
        "权力结构调整", "交通节点中断", "传闻蔓延", "突发灾害", "关键人物失踪"
    ][i % 10]

    return f"""### 事件 {i:02d}｜{phase}：{seed}
- **时间锚点**：{era}·第{i}节点
- **剧情设定**：在“{title}”背景下，围绕“{seed}”出现系统性连锁反应。地方秩序与个人选择被同时推到台前，既有规则开始承压。
- **主要角色**：{r1}、{r2}、地方协调者、受影响群体代表。
- **剧情发展**：
  1. 前兆出现：小范围异常被当作个案处理；
  2. 事态放大：多个节点出现同类问题，舆论/组织注意力上升；
  3. 立场分化：围绕“{cf}”形成两种以上路线；
  4. 临界抉择：主角群必须在效率、道义、风险中做取舍；
  5. 阶段结果：问题被部分解决，但留下后续伏笔与关系裂痕。
- **可参与切口（给新角色）**：
  - 作为执行者：负责一线调查、护送、协调、救治或谈判；
  - 作为观察者：记录线索并影响公共叙事；
  - 作为利益相关方：承担代价并提出替代方案；
  - 作为中立调停者：在冲突双方之间建立有限共识。
- **后续钩子**：一次未公开会议、一个被篡改的记录、一个尚未兑现的承诺。
"""

for key, cfg in worldviews.items():
    out = Path("docs/worldviews/events") / f"{key}-events.md"
    lines = []
    lines.append(f"# 事件库｜{cfg['title']}（50事件·时间序）\n")
    lines.append("\n> 用途：角色在该世界观中的剧情挂载。每条事件含设定、核心角色、发展路径、参与切口。\n")
    for i in range(1, 51):
        phase = cfg["phases"][(i-1)//10]
        lines.append(mk_event(i, phase, cfg["roles"], cfg["conflicts"], cfg["title"]))
    out.write_text("\n".join(lines), encoding="utf-8")

print("generated", len(worldviews), "files")
